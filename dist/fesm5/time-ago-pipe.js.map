{"version":3,"file":"time-ago-pipe.js","sources":["ng://time-ago-pipe/translate.ts","ng://time-ago-pipe/time-ago.pipe.ts","ng://time-ago-pipe/time-ago-pipe.module.ts","ng://time-ago-pipe/time-ago-pipe.ts"],"sourcesContent":["export class Translate {\r\n\r\n    private translations: Object = {};\r\n\r\n    constructor() {\r\n        this.translations['en'] = {\r\n            'a few seconds ago': 'a few seconds ago',\r\n            'seconds ago': (p) => `${p.seconds} seconds ago`,\r\n            'a minute ago': 'a minute ago',\r\n            'minutes ago': (p) => `${p.minutes} minutes ago`,\r\n            'an hour ago': 'an hour ago',\r\n            'hours ago': (p) => `${p.hours} hours ago`,\r\n            'a day ago': 'a day ago',\r\n            'days ago': (p) => `${p.days} days ago`,\r\n            'a month ago': 'a month ago',\r\n            'months ago': (p) => `${p.months} months ago`,\r\n            'a year ago': 'a year ago',\r\n            'years ago': (p) => `${p.years} years ago`\r\n        };\r\n\r\n        this.translations['fr'] = {\r\n            'a few seconds ago': 'il y a quelques secondes',\r\n            'seconds ago': (p) => `il y a ${p.seconds} secondes`,\r\n            'a minute ago': 'il y a une minute',\r\n            'minutes ago': (p) => `il y a ${p.minutes} minutes`,\r\n            'an hour ago': 'il y a une heure',\r\n            'hours ago': (p) => `il y a ${p.hours} heures`,\r\n            'a day ago': 'hier',\r\n            'days ago': (p) => `il y a ${p.days} jours`,\r\n            'a month ago': 'il y a un mois',\r\n            'months ago': (p) => `il y a ${p.months} mois`,\r\n            'a year ago': 'il y a un an',\r\n            'years ago': (p) => `il y a ${p.years} ans`\r\n        };\r\n    }\r\n\r\n    translate(locale: string, messageKey: string, parameters?: Object): string {\r\n\r\n        const translationsInLocale = this.translations[locale];\r\n\r\n        if (translationsInLocale) {\r\n            const translation = translationsInLocale[messageKey];\r\n\r\n            if (translation) {\r\n                if (typeof translation == 'function') {\r\n                    return translation(parameters);\r\n                }\r\n                return translation;\r\n            }\r\n        }\r\n\r\n        return messageKey;\r\n    }\r\n\r\n}\r\n","import {Pipe, PipeTransform, NgZone, ChangeDetectorRef, OnDestroy} from \"@angular/core\";\r\nimport {Translate} from './translate';\r\n\r\n@Pipe({\r\n\tname:'timeAgo',\r\n\tpure:false\r\n})\r\nexport class TimeAgoPipe implements PipeTransform, OnDestroy {\r\n\tprivate timer: number;\r\n\tprivate translate: Translate = new Translate();\r\n\r\n\tconstructor(private changeDetectorRef: ChangeDetectorRef, private ngZone: NgZone) {}\r\n\ttransform(value:string, locale?: string) {\r\n\t\tthis.removeTimer();\r\n\t\tlet d = new Date(value);\r\n\t\tlet now = new Date();\r\n\t\tlet seconds = Math.round(Math.abs((now.getTime() - d.getTime())/1000));\r\n\t\tlet timeToUpdate = this.getSecondsUntilUpdate(seconds) *1000;\r\n\t\tthis.timer = this.ngZone.runOutsideAngular(() => {\r\n\t\t\tif (typeof window !== 'undefined') {\r\n\t\t\t\treturn window.setTimeout(() => {\r\n\t\t\t\t\tthis.ngZone.run(() => this.changeDetectorRef.markForCheck());\r\n\t\t\t\t}, timeToUpdate);\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t});\r\n\r\n\t\treturn this.getI18nMessage(seconds, locale || 'en');\r\n\t}\r\n\r\n\tgetI18nMessage(seconds:number, locale: string) {\r\n\t\tlet minutes = Math.round(Math.abs(seconds / 60));\r\n\t\tlet hours = Math.round(Math.abs(minutes / 60));\r\n\t\tlet days = Math.round(Math.abs(hours / 24));\r\n\t\tlet months = Math.round(Math.abs(days/30.416));\r\n\t\tlet years = Math.round(Math.abs(days/365));\r\n\r\n\r\n\t\tif (seconds <= 45) {\r\n\t\t\treturn this.translate.translate(locale, 'a few seconds ago');\r\n\t\t} else if (seconds <= 90) {\r\n\t\t\treturn this.translate.translate(locale, 'a minute ago');\r\n\t\t} else if (minutes <= 45) {\r\n\t\t\treturn this.translate.translate(locale, 'minutes ago', { minutes });\r\n\t\t} else if (minutes <= 90) {\r\n\t\t\treturn this.translate.translate(locale, 'an hour ago');\r\n\t\t} else if (hours <= 22) {\r\n\t\t\treturn this.translate.translate(locale, 'hours ago', { hours });\r\n\t\t} else if (hours <= 36) {\r\n\t\t\treturn this.translate.translate(locale, 'a day ago');\r\n\t\t} else if (days <= 25) {\r\n\t\t\treturn this.translate.translate(locale, 'days ago', { days });\r\n\t\t} else if (days <= 45) {\r\n\t\t\treturn this.translate.translate(locale, 'a month ago');\r\n\t\t} else if (days <= 345) {\r\n\t\t\treturn this.translate.translate(locale, 'months ago', { months });\r\n\t\t} else if (days <= 545) {\r\n\t\t\treturn this.translate.translate(locale, 'a year ago');\r\n\t\t} else { // (days > 545)\r\n\t\t\treturn this.translate.translate(locale, 'years ago', { years });\r\n\t\t}\r\n\t}\r\n\r\n\tngOnDestroy(): void {\r\n\t\tthis.removeTimer();\r\n\t}\r\n\tprivate removeTimer() {\r\n\t\tif (this.timer) {\r\n\t\t\twindow.clearTimeout(this.timer);\r\n\t\t\tthis.timer = null;\r\n\t\t}\r\n\t}\r\n\tprivate getSecondsUntilUpdate(seconds:number) {\r\n\t\tlet min = 60;\r\n\t\tlet hr = min * 60;\r\n\t\tlet day = hr * 24;\r\n\t\tif (seconds < min) { // less than 1 min, update ever 2 secs\r\n\t\t\treturn 2;\r\n\t\t} else if (seconds < hr) { // less than an hour, update every 30 secs\r\n\t\t\treturn 30;\r\n\t\t} else if (seconds < day) { // less then a day, update every 5 mins\r\n\t\t\treturn 300;\r\n\t\t} else { // update every hour\r\n\t\t\treturn 3600;\r\n\t\t}\r\n\t}\r\n}\r\n","import {NgModule} from \"@angular/core\";\r\nimport {CommonModule} from '@angular/common'\r\nimport {TimeAgoPipe} from \"./time-ago.pipe\";\r\n\r\n@NgModule({\r\n    declarations: [\r\n        TimeAgoPipe\r\n    ],\r\n    imports: [\r\n        CommonModule\r\n    ],\r\n    exports: [\r\n        TimeAgoPipe\r\n    ]\r\n})\r\nexport class TimeAgoPipeModule {\r\n}\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n\nexport {TimeAgoPipe as Éµa} from './time-ago.pipe';"],"names":[],"mappings":"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"}